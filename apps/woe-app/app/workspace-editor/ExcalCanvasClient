"use client";

import dynamic from "next/dynamic";
import { useRef, useCallback } from "react";
import type { ExcalidrawImperativeAPI } from "@excalidraw/excalidraw";
import "@excalidraw/excalidraw/index.css";

// Pick the named export so React gets a component, not the module.
const Excalidraw = dynamic(
  () => import("@excalidraw/excalidraw").then(m => m.Excalidraw),
  { ssr: false, loading: () => <div className="p-4">Loading canvasâ€¦</div> }
);

export default function ExcalCanvasClient() {
  const apiRef = useRef<ExcalidrawImperativeAPI | null>(null);
  const onReady = useCallback((api: ExcalidrawImperativeAPI) => {
    apiRef.current = api;
  }, []);

  return <Excalidraw excalidrawAPI={onReady} onReady={onReady} />;
}
